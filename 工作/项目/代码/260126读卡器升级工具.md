---
area: "[[工作]]"
status: TODO
createTime: 2026-01-26 14:31:43
deadline: 2026-01-26T14:31
doneTime:
tags:
  - project
  - code
type: none
---

## 待办列表
- [ ] 编码
- [ ] 测试
- [ ] 合并

二、读卡器升级指令

读卡器升级指令规范：

|   |   |   |
|---|---|---|
|字段|字节长度|值|
|帧头|1|55|
|命令码|1||
|数据长度|2||
|包号|2||
|数据|N||
|CRC校验|2|校验范围：数据|
|帧尾|1|AA|

1、开始升级指令发送

1.1 控制器发送指令

|       |     |           |          |          |          |          |          |          |     |
| ----- | --- | --------- | -------- | -------- | -------- | -------- | -------- | -------- | --- |
| 帧头    | 命令码 | 2字节数据长度低位 | 2字节数据长度高 | 2字节总包数低位 | 2字节总包数高位 | 数据       | 2字节CRC低位 | 2字节CRC高位 | 帧尾  |
| 4字节预留 |     |           |          |          |          |          |          |          |     |
| 55    | 81  | 04        | 00       |          |          | 00000000 |          |          | AA  |

1.2 读卡器应答

|       |     |           |          |          |          |          |          |          |     |
| ----- | --- | --------- | -------- | -------- | -------- | -------- | -------- | -------- | --- |
| 帧头    | 命令码 | 2字节数据长度低位 | 2字节数据长度高 | 2字节总包数低位 | 2字节总包数高位 | 数据       | 2字节CRC低位 | 2字节CRC高位 | 帧尾  |
| 4字节预留 |     |           |          |          |          |          |          |          |     |
| 55    | 01  | 00        | 04       |          |          | 00000000 |          |          | AA  |

2、升级文件发送

2.1 控制器发送文件包

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|帧头|命令码|2字节数据长度高位|2字节数据长度低位|2字节包编号高位|2字节包编号低位|数据|2字节CRC高位|2字节CRC低位|帧尾|
|256字节升级包|
|55|82|01|00|xx|xx||||AA|

2.2 读卡器应答结果

|   |   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|---|
|帧头|命令码|2字节数据长度高位|2字节数据长度低位|2字节包编号高位|2字节包编号低位|数据|2字节CRC高位|2字节CRC低位|帧尾|
|文件接收结果|
|55|02|00|01|xx|xx|成功：0xAA<br><br>失败：0x55|||AA|

3、升级结果

3.1 读卡器发送升级结果

|   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|
|帧头|命令码|2字节数据长度高位|2字节数据长度低位|2字节版本号|数据<br><br>升级结果|2字节CRC高位|2字节CRC低位|帧尾|
|55|03|00|01|0000|成功：0xAA<br><br>失败：0x55|||AA|

3.2 控制器应答

|   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|
|帧头|命令码|2字节数据长度高位|2字节数据长度低位|2字节版本号|数据<br><br>升级结果|2字节CRC高位|2字节CRC低位|帧尾|
|55|83|00|01|0000|成功：0xAA<br><br>失败：0x55|||AA|